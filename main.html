<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resort POS System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --resort-primary: #0b5ed7;
            --resort-secondary: #198754;
            --resort-accent: #ffb703;
            --bg-muted: #f5f7fb;
            --receipt-width: 320px;
            --vat-rate: 15%;
        }
        
        body {
            font-size: 0.9rem;
            background-color: var(--bg-muted);
            font-family: 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial, sans-serif;
        }
        
        /* Sidebar */
        .sidebar {
            width: 72px;
            height: 100vh;
            background: linear-gradient(180deg,#23314a,#1b2836);
            position: fixed;
            left: 0;
            top: 0;
            padding-top: 20px;
            transition: width 0.3s;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .sidebar:hover {
            width: 220px;
        }
        
        .sidebar-item {
            color: #ecf0f1;
            padding: 12px 15px;
            text-decoration: none;
            display: flex;
            align-items: center;
            white-space: nowrap;
            overflow: hidden;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .sidebar-item:hover {
            background: #34495e;
            border-left-color: var(--resort-accent);
            color: white;
        }
        
        .sidebar-item.active {
            background: var(--resort-primary);
            border-left-color: white;
        }
        
        .sidebar-icon {
            min-width: 30px;
            font-size: 1.1rem;
        }
        
        .sidebar-text {
            margin-left: 15px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .sidebar:hover .sidebar-text {
            opacity: 1;
        }
        
        /* Main Content */
        .main-content {
            margin-left: 70px;
            padding: 10px;
            transition: margin-left 0.3s;
        }
        
        .sidebar:hover ~ .main-content {
            margin-left: 220px;
        }
        
        /* POS Layout */
        .pos-container {
            display: flex;
            gap: 10px;
            height: 85vh;
        }

        /* Buttons */
        .btn-action {
            font-size: 0.85rem;
            padding: 10px 12px;
            border-radius: 6px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.04);
        }
        
        .pos-left {
            flex: 3;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }
        
        .pos-right {
            flex: 1;
            max-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        /* Cart Styles */
        .cart-header {
            background: var(--resort-primary);
            color: white;
            padding: 12px;
            border-radius: 8px 8px 0 0;
        }
        
        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .cart-item {
            border-bottom: 1px solid #eee;
            padding: 8px 0;
        }
        
        .item-quantity {
            width: 50px;
            text-align: center;
            font-size: 0.8rem;
            padding: 2px;
        }
        
        /* Receipt */
        .receipt-container {
            background: white;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 12px;
        }
        
        .receipt-header {
            text-align: center;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 8px;
            margin-bottom: 10px;
        }
        
        .receipt-items {
            margin: 8px 0;
        }
        
        .receipt-item {
            display: flex;
            justify-content: space-between;
            margin: 2px 0;
        }
        
        .receipt-total {
            border-top: 1px dashed #ccc;
            padding-top: 8px;
            margin-top: 10px;
            font-weight: bold;
        }
        
        /* Quick Items */
        .quick-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
            padding: 10px;
        }
        
        .quick-item-card {
            padding: 8px;
            text-align: center;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quick-item-card:hover {
            background: var(--resort-primary);
            color: white;
            transform: translateY(-1px);
        }
        
        .quick-item-price {
            font-weight: bold;
            color: var(--resort-secondary);
        }
        
        /* Category Tabs */
        .category-tabs {
            display: flex;
            gap: 5px;
            padding: 10px;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
        }
        
        .category-tab {
            padding: 6px 12px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            white-space: nowrap;
            font-size: 0.8rem;
        }
        
        .category-tab.active {
            background: var(--resort-primary);
            color: white;
            border-color: var(--resort-primary);
        }
        
        /* Room Selector */
        .room-selector {
            background: #e9ecef;
            padding: 10px;
            border-radius: 6px;
            margin: 10px;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            padding: 10px;
        }
        
        .btn-action {
            font-size: 0.8rem;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        /* Module Content */
        .module-content {
            display: none;
        }
        
        .module-content.active {
            display: block;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 5px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }
        
        /* Room Badge */
        .room-badge {
            background: #0d6efd;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">

        <a href="#" class="sidebar-item active" data-module="restaurant">
            <i class="sidebar-icon bi bi-cup-hot"></i>
            <span class="sidebar-text">Restaurant</span>
        </a>

        <a href="#" class="sidebar-item" data-module="accommodation">
            <i class="sidebar-icon bi bi-building"></i>
            <span class="sidebar-text">Accommodation</span>
        </a>
        
        <a href="#" class="sidebar-item" data-module="activities">
            <i class="sidebar-icon bi bi-bicycle"></i>
            <span class="sidebar-text">Activities</span>
        </a>
        <a href="#" class="sidebar-item" data-module="events">
            <i class="sidebar-icon bi bi-calendar-event"></i>
            <span class="sidebar-text">Events</span>
        </a>
        <a href="#" class="sidebar-item" data-module="conferences">
            <i class="sidebar-icon bi bi-people"></i>
            <span class="sidebar-text">Conferences</span>
        </a>
        <a href="#" class="sidebar-item" data-module="construction">
            <i class="sidebar-icon bi bi-tools"></i>
            <span class="sidebar-text">Construction</span>
        </a>
        <div class="mt-auto">
            <a href="#" class="sidebar-item" data-module="settings" id="settingsBtn">
                <i class="sidebar-icon bi bi-gear"></i>
                <span class="sidebar-text">Settings</span>
            </a>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        
        <!-- Restaurant Module -->
        <div id="restaurant-module" class="module-content active">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header bg-success">
                        <h6 class="mb-0"><i class="bi bi-cup-hot"></i> Restaurant POS</h6>
                    </div>
                    
                    <div class="room-selector">
                        <div class="d-flex gap-2">
                            <select class="form-select form-select-sm" id="restaurantRoomSelect">
                                <option value="">Select Room (Optional)</option>
                                <option value="101">101 - John Smith</option>
                                <option value="102">102 - Sarah Johnson</option>
                                <option value="103">103 - Mike Wilson</option>
                            </select>
                            <button class="btn btn-sm btn-outline-primary" onclick="attachRestaurantToRoom()">
                                <i class="bi bi-link"></i> Attach
                            </button>
                        </div>
                    </div>
                    
                    <div class="d-flex align-items-center gap-2 mb-2" id="restaurantSearchWrapper" style="display:flex;">
                        <input type="search" id="restaurantSearch" class="form-control form-control-sm" placeholder="Search menu (e.g. Bruschetta)">
                        <button class="btn btn-sm btn-outline-secondary" id="restaurantClearSearch" title="Clear search">
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>

                    <div class="category-tabs">
                        <div class="category-tab active" data-category="appetizers">Appetizers</div>
                        <div class="category-tab" data-category="mains">Main Courses</div>
                        <div class="category-tab" data-category="desserts">Desserts</div>
                        <div class="category-tab" data-category="beverages">Beverages</div>
                        <div class="category-tab" data-category="alcohol">Alcohol</div>
                    </div>
                    
                    <div class="cart-items" id="restaurantCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No food items</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="restaurantItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="restaurantReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Restaurant Bill</small>
                            <div class="mt-1 text-start">
                                <small>Table: 12</small><br>
                                <small>Room: <span id="restaurantReceiptRoom">--</span></small><br>
                                <small>Time: <span id="restaurantTime">10:30 AM</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="restaurantReceiptItems">
                            <div class="text-center text-muted">--- No items ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="restaurantSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="restaurantTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="restaurantTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('restaurant')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('restaurant')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>

                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('restaurant')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="saveOrder('restaurant')">
                            <i class="bi bi-save"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
        

        <div id="accommodation-module" class="module-content">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header">
                        <h6 class="mb-0"><i class="bi bi-building"></i> Accommodation POS</h6>
                    </div>
                    
                    <div class="room-selector">
                        <select class="form-select form-select-sm" id="accommodationRoomSelect">
                            <option value="101">101 - Deluxe Ocean View (John Smith)</option>
                            <option value="102">102 - Suite (Sarah Johnson)</option>
                            <option value="103">103 - Standard Room (Mike Wilson)</option>
                            <option value="201">201 - Family Suite (Davis Family)</option>
                        </select>
                    </div>
                    
                    <div class="category-tabs">
                        <div class="category-tab active" data-category="room-charges">Room Charges</div>
                        <div class="category-tab" data-category="restaurant-attached">Restaurant Charges</div>
                        <div class="category-tab" data-category="activities-attached">Activity Charges</div>
                        <div class="category-tab" data-category="services">Services</div>
                    </div>
                    
                    <div class="cart-items" id="accommodationCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No room charges</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="accommodationItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="accommodationReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Room Charges</small>
                            <div class="mt-1 text-start">
                                <small>Room: <span id="receiptRoom">101</span></small><br>
                                <small>Date: <span id="receiptDate">Nov 15, 2023</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="accommodationReceiptItems">
                            <div class="text-center text-muted">--- No charges ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="accommodationSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="accommodationTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="accommodationTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('accommodation')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('accommodation')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>
                        <button class="btn btn-info btn-action" onclick="emailReceipt('accommodation')">
                            <i class="bi bi-envelope"></i> Email
                        </button>
                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('accommodation')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-warning btn-action" onclick="attachToRoom('accommodation')">
                            <i class="bi bi-link"></i> Attach
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="viewRoomStatement()">
                            <i class="bi bi-receipt"></i> Statement
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activities Module -->
        <div id="activities-module" class="module-content">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header" style="background: #fd7e14;">
                        <h6 class="mb-0"><i class="bi bi-bicycle"></i> Activities POS</h6>
                    </div>
                    
                    <div class="room-selector">
                        <div class="d-flex gap-2">
                            <select class="form-select form-select-sm" id="activitiesRoomSelect">
                                <option value="">Select Room (Optional)</option>
                                <option value="101">101 - John Smith</option>
                                <option value="102">102 - Sarah Johnson</option>
                                <option value="103">103 - Mike Wilson</option>
                            </select>
                            <button class="btn btn-sm btn-outline-primary" onclick="attachActivitiesToRoom()">
                                <i class="bi bi-link"></i> Attach
                            </button>
                        </div>
                    </div>
                    
                    <div class="category-tabs">
                        <div class="category-tab active" data-category="water">Water Sports</div>
                        <div class="category-tab" data-category="adventure">Adventure</div>
                        <div class="category-tab" data-category="tours">Tours</div>
                        <div class="category-tab" data-category="equipment">Equipment</div>
                    </div>
                    
                    <div class="cart-items" id="activitiesCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No activities booked</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="activitiesItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="activitiesReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Activities Booking</small>
                            <div class="mt-1 text-start">
                                <small>Instructor: Alex</small><br>
                                <small>Room: <span id="activitiesReceiptRoom">--</span></small><br>
                                <small>Date: <span id="activitiesDate">Nov 15, 2023</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="activitiesReceiptItems">
                            <div class="text-center text-muted">--- No activities ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="activitiesSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="activitiesTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="activitiesTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('activities')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('activities')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>
                        <button class="btn btn-info btn-action" onclick="scheduleActivity()">
                            <i class="bi bi-calendar"></i> Schedule
                        </button>
                        <button class="btn btn-warning btn-action" onclick="addParticipants()">
                            <i class="bi bi-people"></i> Participants
                        </button>
                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('activities')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="saveOrder('activities')">
                            <i class="bi bi-save"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Events Module -->
        <div id="events-module" class="module-content">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header" style="background: #6f42c1;">
                        <h6 class="mb-0"><i class="bi bi-calendar-event"></i> Events POS</h6>
                        <small>Weddings • Parties • Celebrations</small>
                    </div>
                    
                    <div class="category-tabs">
                        <div class="category-tab active" data-category="venues">Venue Rental</div>
                        <div class="category-tab" data-category="catering">Catering</div>
                        <div class="category-tab" data-category="decor">Decorations</div>
                        <div class="category-tab" data-category="packages">Packages</div>
                    </div>
                    
                    <div class="cart-items" id="eventsCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No event items</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="eventsItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="eventsReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Events Booking</small>
                            <div class="mt-1 text-start">
                                <small>Event Type: <span id="eventType">--</span></small><br>
                                <small>Date: <span id="eventsDate">Nov 15, 2023</span></small><br>
                                <small>Guests: <span id="eventGuests">0</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="eventsReceiptItems">
                            <div class="text-center text-muted">--- No items ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="eventsSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="eventsTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="eventsTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('events')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('events')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>
                        <button class="btn btn-info btn-action" onclick="bookVenue()">
                            <i class="bi bi-calendar-check"></i> Book Venue
                        </button>
                        <button class="btn btn-warning btn-action" onclick="addGuestCount()">
                            <i class="bi bi-people"></i> Guests
                        </button>
                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('events')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="saveOrder('events')">
                            <i class="bi bi-save"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Conferences Module -->
        <div id="conferences-module" class="module-content">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header" style="background: #20c997;">
                        <h6 class="mb-0"><i class="bi bi-people"></i> Conferences POS</h6>
                        <small>Meetings • Seminars • Corporate Events</small>
                    </div>
                    
                    <div class="category-tabs">
                        <div class="category-tab active" data-category="rooms">Conference Rooms</div>
                        <div class="category-tab" data-category="equipment">AV Equipment</div>
                        <div class="category-tab" data-category="catering">Catering</div>
                        <div class="category-tab" data-category="services">Services</div>
                    </div>
                    
                    <div class="cart-items" id="conferencesCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No conference items</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="conferencesItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="conferencesReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Conference Booking</small>
                            <div class="mt-1 text-start">
                                <small>Company: <span id="conferenceCompany">--</span></small><br>
                                <small>Date: <span id="conferencesDate">Nov 15, 2023</span></small><br>
                                <small>Attendees: <span id="conferenceAttendees">0</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="conferencesReceiptItems">
                            <div class="text-center text-muted">--- No items ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="conferencesSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="conferencesTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="conferencesTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('conferences')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('conferences')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>
                        <button class="btn btn-info btn-action" onclick="bookConference()">
                            <i class="bi bi-calendar-check"></i> Book Room
                        </button>
                        <button class="btn btn-warning btn-action" onclick="addAttendees()">
                            <i class="bi bi-people"></i> Attendees
                        </button>
                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('conferences')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="saveOrder('conferences')">
                            <i class="bi bi-save"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Construction Module -->
        <div id="construction-module" class="module-content">
            <div class="pos-container">
                <div class="pos-left">
                    <div class="cart-header bg-dark">
                        <h6 class="mb-0"><i class="bi bi-tools"></i> Construction POS</h6>
                        <small>Materials • Labor • Contractor Services</small>
                    </div>
                    
                    <div class="category-tabs">
                        <div class="category-tab active" data-category="materials">Materials</div>
                        <div class="category-tab" data-category="labor">Labor</div>
                        <div class="category-tab" data-category="equipment">Equipment</div>
                        <div class="category-tab" data-category="services">Services</div>
                    </div>
                    
                    <div class="cart-items" id="constructionCartItems">
                        <div class="text-center text-muted p-4">
                            <i class="bi bi-cart-x fs-3"></i>
                            <p class="mt-2">No construction items</p>
                        </div>
                    </div>
                    
                    <div class="quick-items-grid" id="constructionItems">
                        <!-- Items will load here -->
                    </div>
                </div>
                
                <div class="pos-right">
                    <div class="receipt-container" id="constructionReceipt">
                        <div class="receipt-header">
                            <h6>PAKANAKA RESORT</h6>
                            <small>Construction Services</small>
                            <div class="mt-1 text-start">
                                <small>Project: <span id="constructionProject">--</span></small><br>
                                <small>Date: <span id="constructionDate">Nov 15, 2023</span></small><br>
                                <small>Contractor: <span id="constructionContractor">--</span></small>
                            </div>
                        </div>
                        
                        <div class="receipt-items" id="constructionReceiptItems">
                            <div class="text-center text-muted">--- No items ---</div>
                        </div>
                        
                        <div class="receipt-total">
                            <div class="d-flex justify-content-between">
                                <span>Subtotal:</span>
                                <span id="constructionSubtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Tax (15%):</span>
                                <span id="constructionTax">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between fw-bold">
                                <span>TOTAL:</span>
                                <span id="constructionTotal">$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-action" onclick="printReceipt('construction')">
                            <i class="bi bi-printer"></i> Print
                        </button>
                        <button class="btn btn-success btn-action" onclick="processPayment('construction')">
                            <i class="bi bi-credit-card"></i> Pay
                        </button>
                        <button class="bi bi-tools"></i> Project
                        </button>
                        <button class="btn btn-warning btn-action" onclick="addContractor()">
                            <i class="bi bi-person"></i> Contractor
                        </button>
                        <button class="btn btn-danger btn-action" onclick="clearModuleOrder('construction')">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                        <button class="btn btn-secondary btn-action" onclick="saveOrder('construction')">
                            <i class="bi bi-save"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header py-1">
                    <h6 class="modal-title" id="paymentModalTitle">Process Payment</h6>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-2">
                    <div class="alert alert-info py-1 mb-2">
                        <small>Total: <strong id="paymentTotal">$0.00</strong></small>
                    </div>
                    
                    <div class="mb-2">
                        <label class="form-label">Payment Method</label>
                        <select class="form-select form-select-sm" id="paymentMethod">
                            <option>Credit Card</option>
                            <option>Cash</option>
                            <option>Room Charge</option>
                            <option>Resort Credit</option>
                        </select>
                    </div>

                    <div class="mb-2" id="paymentSendToKitchenRow" style="display:none;">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="paymentSendToKitchen">
                            <label class="form-check-label" for="paymentSendToKitchen">Send to Kitchen</label>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-1">
                        <button class="btn btn-success btn-sm" onclick="confirmPayment()">
                            <i class="bi bi-check-circle"></i> Confirm Payment
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Module -->
    <div id="settings-module" class="module-content">
        <div class="container p-3">
            <h5>Settings</h5>
            <ul class="nav nav-tabs mb-3" id="settingsTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="settings-restaurant-tab" data-bs-toggle="tab" data-bs-target="#settings-restaurant" type="button" role="tab">Restaurant Items</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="settings-rooms-tab" data-bs-toggle="tab" data-bs-target="#settings-rooms" type="button" role="tab">Rooms</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="settings-inventory-tab" data-bs-toggle="tab" data-bs-target="#settings-inventory" type="button" role="tab">Inventory</button>
                </li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane fade show active" id="settings-restaurant" role="tabpanel">
                    <form id="restaurantItemForm" class="row g-2 mb-3">
                        <div class="col-5">
                            <input type="text" id="newRestaurantItemName" class="form-control form-control-sm" placeholder="Item name">
                        </div>
                        <div class="col-3">
                            <input type="number" id="newRestaurantItemPrice" class="form-control form-control-sm" placeholder="Price">
                        </div>
                        <div class="col-3">
                            <select id="newRestaurantItemCategory" class="form-select form-select-sm">
                                <option value="appetizers">Appetizers</option>
                                <option value="mains">Main Courses</option>
                                <option value="desserts">Desserts</option>
                                <option value="beverages">Beverages</option>
                                <option value="alcohol">Alcohol</option>
                            </select>
                        </div>
                        <div class="col-1">
                            <button class="btn btn-sm btn-primary" type="button" onclick="addRestaurantItemFromSettings()">Add</button>
                        </div>
                    </form>

                    <div id="settingsRestaurantList"></div>
                </div>

                <div class="tab-pane fade" id="settings-rooms" role="tabpanel">
                    <form id="roomsForm" class="row g-2 mb-3">
                        <div class="col-4">
                            <input type="text" id="newRoomValue" class="form-control form-control-sm" placeholder="Room number (e.g. 104)">
                        </div>
                        <div class="col-6">
                            <input type="text" id="newRoomLabel" class="form-control form-control-sm" placeholder="Label (e.g. 104 - Twin)">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" type="button" onclick="addRoomFromSettings()">Add</button>
                        </div>
                    </form>

                    <div id="settingsRoomsList"></div>
                </div>

                <div class="tab-pane fade" id="settings-inventory" role="tabpanel">
                    <form id="inventoryForm" class="row g-2 mb-3">
                        <div class="col-6">
                            <input type="text" id="newInventoryName" class="form-control form-control-sm" placeholder="Item name">
                        </div>
                        <div class="col-4">
                            <input type="number" id="newInventoryQty" class="form-control form-control-sm" placeholder="Qty">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" type="button" onclick="addInventoryFromSettings()">Add</button>
                        </div>
                    </form>

                    <div id="settingsInventoryList"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Data structure for all modules
        const moduleData = {
            accommodation: {
                items: [],
                categories: ['room-charges', 'restaurant-attached', 'activities-attached', 'services'],
                selectedRoom: '101',
                itemsList: {
                    'room-charges': [
                        { name: "Room Night", price: 299, icon: "bi-moon" },
                        { name: "Late Check-out", price: 75, icon: "bi-clock" },
                        { name: "Early Check-in", price: 50, icon: "bi-sun" }
                    ],
                    'restaurant-attached': [
                        { name: "Restaurant Bill", price: 0, icon: "bi-cup-hot" },
                        { name: "Room Service", price: 15, icon: "bi-bell" },
                        { name: "Mini-bar Refill", price: 45, icon: "bi-cup-straw" }
                    ],
                    'activities-attached': [
                        { name: "Activity Ticket", price: 0, icon: "bi-ticket" },
                        { name: "Tour Booking", price: 0, icon: "bi-compass" },
                        { name: "Equipment Rental", price: 0, icon: "bi-bicycle" }
                    ],
                    'services': [
                        { name: "Laundry Service", price: 35, icon: "bi-bucket" },
                        { name: "Spa Treatment", price: 85, icon: "bi-spa" },
                        { name: "Butler Service", price: 100, icon: "bi-person" }
                    ]
                },
                rooms: [
                    { value: '101', label: '101 - Deluxe Ocean View (John Smith)' },
                    { value: '102', label: '102 - Suite (Sarah Johnson)' },
                    { value: '103', label: '103 - Standard Room (Mike Wilson)' },
                    { value: '201', label: '201 - Family Suite (Davis Family)' }
                ]
            },
            restaurant: {
                items: [],
                categories: ['appetizers', 'mains', 'desserts', 'beverages', 'alcohol'],
                attachedRoom: '',
                itemsList: {
                    'appetizers': [
                        { name: "Bruschetta", price: 12, icon: "bi-bread-slice" },
                        { name: "Calamari", price: 16, icon: "bi-fish" },
                        { name: "Garlic Bread", price: 8, icon: "bi-bread-slice" }
                    ],
                    'mains': [
                        { name: "Grilled Salmon", price: 28, icon: "bi-fish" },
                        { name: "Ribeye Steak", price: 42, icon: "bi-egg-fried" },
                        { name: "Vegetable Pasta", price: 22, icon: "bi-egg" }
                    ],
                    'desserts': [
                        { name: "Chocolate Cake", price: 12, icon: "bi-cake" },
                        { name: "Ice Cream", price: 8, icon: "bi-snow" },
                        { name: "Cheese Plate", price: 16, icon: "bi-egg" }
                    ],
                    'beverages': [
                        { name: "Fresh Juice", price: 6, icon: "bi-cup-straw" },
                        { name: "Soft Drink", price: 4, icon: "bi-cup" },
                        { name: "Coffee", price: 5, icon: "bi-cup-hot" }
                    ],
                    'alcohol': [
                        { name: "House Wine", price: 9, icon: "bi-cup-straw" },
                        { name: "Cocktail", price: 14, icon: "bi-cup-straw" },
                        { name: "Local Beer", price: 7, icon: "bi-cup" }
                    ]
                }
            },
            activities: {
                items: [],
                categories: ['water', 'adventure', 'tours', 'equipment'],
                attachedRoom: '',
                itemsList: {
                    'water': [
                        { name: "Jet Ski Rental", price: 85, icon: "bi-water" },
                        { name: "Scuba Diving", price: 120, icon: "bi-water" },
                        { name: "Snorkeling", price: 45, icon: "bi-water" }
                    ],
                    'adventure': [
                        { name: "Zip Lining", price: 65, icon: "bi-activity" },
                        { name: "Rock Climbing", price: 55, icon: "bi-activity" },
                        { name: "Canoeing", price: 40, icon: "bi-activity" }
                    ],
                    'tours': [
                        { name: "Island Tour", price: 65, icon: "bi-compass" },
                        { name: "PAKANAKA Cruise", price: 90, icon: "bi-compass" },
                        { name: "City Excursion", price: 55, icon: "bi-compass" }
                    ],
                    'equipment': [
                        { name: "Bike Rental", price: 20, icon: "bi-bicycle" },
                        { name: "Kayak Rental", price: 30, icon: "bi-bicycle" },
                        { name: "Snorkel Gear", price: 15, icon: "bi-bicycle" }
                    ]
                }
            },
            events: {
                items: [],
                categories: ['venues', 'catering', 'decor', 'packages']
            },
            conferences: {
                items: [],
                categories: ['rooms', 'equipment', 'catering', 'services']
            },
            construction: {
                items: [],
                categories: ['materials', 'labor', 'equipment', 'services']
            },
            inventory: {
                items: [
                    { name: 'Napkins', qty: 200 },
                    { name: 'Olive Oil', qty: 25 }
                ]
            }
        }

        const VAT_RATE = 0.15;
        let currentModule = 'accommodation';
        let currentCategory = 'room-charges';
        const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));

        // Initialize
        function init() {
            updateDateTime();
            setupEventListeners();

            // Wire restaurant search handlers (if the element exists)
            const searchInput = document.getElementById('restaurantSearch');
            if (searchInput) {
                let t = null;
                searchInput.addEventListener('input', () => {
                    clearTimeout(t);
                    t = setTimeout(() => loadCurrentModuleItems(), 200);
                });
                const clearBtn = document.getElementById('restaurantClearSearch');
                if (clearBtn) {
                    clearBtn.addEventListener('click', () => {
                        searchInput.value = '';
                        searchInput.focus();
                        loadCurrentModuleItems();
                    });
                }
            }

            // Detect which module is active in the UI and set JS state to match
            const activeSidebar = document.querySelector('.sidebar-item.active');
            const activeModuleEl = document.querySelector('.module-content.active');
            if (activeSidebar && activeSidebar.dataset.module) {
                currentModule = activeSidebar.dataset.module;
                currentCategory = moduleData[currentModule] && moduleData[currentModule].categories ? moduleData[currentModule].categories[0] : currentCategory;
            } else if (activeModuleEl) {
                const moduleId = activeModuleEl.id.replace('-module', '');
                if (moduleData[moduleId]) {
                    currentModule = moduleId;
                    currentCategory = moduleData[currentModule] && moduleData[currentModule].categories ? moduleData[currentModule].categories[0] : currentCategory;
                }
            }

            // Ensure restaurant search visibility matches the detected active module
            const searchWrapper = document.getElementById('restaurantSearchWrapper');
            if (searchWrapper) {
                if (currentModule === 'restaurant') {
                    searchWrapper.style.display = 'flex';
                } else {
                    searchWrapper.style.display = 'none';
                    const searchInput = document.getElementById('restaurantSearch');
                    if (searchInput) searchInput.value = '';
                }
            }

            loadCurrentModuleItems();
            updateCartDisplay();
            updateReceipt();
        }

        function updateDateTime() {
            const now = new Date();
            document.querySelectorAll('#receiptDate, #restaurantTime, #activitiesDate, #eventsDate, #conferencesDate, #constructionDate').forEach(el => {
                if (el.id.includes('Date')) {
                    el.textContent = now.toLocaleDateString('en-US', { 
                        month: 'short', day: 'numeric', year: 'numeric' 
                    });
                } else if (el.id === 'restaurantTime') {
                    el.textContent = now.toLocaleTimeString('en-US', { 
                        hour: '2-digit', minute: '2-digit' 
                    });
                }
            });
        }

        function setupEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const module = item.dataset.module;
                    
                    if (!module) return;
                    
                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    document.querySelectorAll('.module-content').forEach(m => m.classList.remove('active'));
                    document.getElementById(`${module}-module`).classList.add('active');
                    
                    currentModule = module;
                    currentCategory = moduleData[module] && moduleData[module].categories ? moduleData[module].categories[0] : null;

                    // show or hide restaurant search when switching modules
                    const searchWrapper = document.getElementById('restaurantSearchWrapper');
                    const searchInput = document.getElementById('restaurantSearch');
                    if (searchWrapper) {
                        if (module === 'restaurant') {
                            searchWrapper.style.display = 'flex';
                        } else {
                            searchWrapper.style.display = 'none';
                            if (searchInput) searchInput.value = '';
                        }
                    }

                    // If settings opened, render settings lists
                    if (module === 'settings') {
                        renderSettingsRestaurantList();
                        renderSettingsRoomsList();
                        renderSettingsInventoryList();
                    }

                    loadCurrentModuleItems();
                    updateCartDisplay();
                });
            });

            // Category tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const category = this.dataset.category;
                    
                    this.parentElement.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    currentCategory = category;
                    loadCurrentModuleItems();
                });
            });

            // Room selection for accommodation
            document.getElementById('accommodationRoomSelect')?.addEventListener('change', function() {
                moduleData.accommodation.selectedRoom = this.value;
                document.getElementById('receiptRoom').textContent = this.value;
                updateCartDisplay();
            });

            // Room selection for restaurant
            document.getElementById('restaurantRoomSelect')?.addEventListener('change', function() {
                moduleData.restaurant.attachedRoom = this.value;
                document.getElementById('restaurantReceiptRoom').textContent = this.value || '--';
            });

            // Room selection for activities
            document.getElementById('activitiesRoomSelect')?.addEventListener('change', function() {
                moduleData.activities.attachedRoom = this.value;
                document.getElementById('activitiesReceiptRoom').textContent = this.value || '--';
            });
        }

        function loadCurrentModuleItems() {
            const module = moduleData[currentModule];
            const itemsContainer = document.getElementById(`${currentModule}Items`);
            
            if (!itemsContainer || !module.itemsList || !module.itemsList[currentCategory]) return;
            
            // Read restaurant search if present
            const searchEl = document.getElementById('restaurantSearch');
            const search = (searchEl && searchEl.value) ? searchEl.value.trim().toLowerCase() : '';
            
            itemsContainer.innerHTML = '';
            
            module.itemsList[currentCategory].forEach(item => {
                // If searching in restaurant module, filter by name
                if (currentModule === 'restaurant' && search) {
                    if (!item.name.toLowerCase().includes(search)) return;
                }

                const itemDiv = document.createElement('div');
                itemDiv.className = 'quick-item-card';
                itemDiv.innerHTML = `
                    <i class="bi ${item.icon} fs-5"></i>
                    <div class="mt-1">${item.name}</div>
                    <div class="quick-item-price">${item.price === 0 ? 'Variable' : `$${item.price.toFixed(2)}`}</div>
                `;
                itemDiv.tabIndex = 0;
                itemDiv.addEventListener('click', () => addToCart(item.name, item.price));
                itemDiv.addEventListener('keydown', (e) => { if (e.key === 'Enter') addToCart(item.name, item.price); });
                itemsContainer.appendChild(itemDiv);
            });
        }

        function addToCart(itemName, itemPrice) {
            const module = moduleData[currentModule];
            const existingItem = module.items.find(item => item.name === itemName);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                module.items.push({
                    name: itemName,
                    price: itemPrice,
                    quantity: 1,
                    module: currentModule
                });
            }
            
            updateCartDisplay();
            updateReceipt();
        }

        function updateCartDisplay() {
            const module = moduleData[currentModule];
            const cartContainer = document.getElementById(`${currentModule}CartItems`);
            
            if (!cartContainer) return;
            
            if (module.items.length === 0) {
                cartContainer.innerHTML = `
                    <div class="text-center text-muted p-4">
                        <i class="bi bi-cart-x fs-3"></i>
                        <p class="mt-2">No items</p>
                    </div>
                `;
                return;
            }

            cartContainer.innerHTML = module.items.map(item => `
                <div class="cart-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>${item.name}</strong><br>
                        ${item.price > 0 ? `<small class="text-muted">$${item.price.toFixed(2)} each</small>` : ''}
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="btn-group btn-group-sm me-2">
                            <button class="btn btn-outline-secondary" onclick="updateQuantity('${item.name}', -1)">
                                <i class="bi bi-dash"></i>
                            </button>
                            <input type="number" 
                                   class="form-control item-quantity" 
                                   value="${item.quantity}" 
                                   min="1"
                                   onchange="updateQuantityInput('${item.name}', this.value)">
                            <button class="btn btn-outline-secondary" onclick="updateQuantity('${item.name}', 1)">
                                <i class="bi bi-plus"></i>
                            </button>
                        </div>
                        <h6 class="mb-0 me-2">${item.price > 0 ? `$${(item.price * item.quantity).toFixed(2)}` : 'Variable'}</h6>
                        <button class="btn btn-link text-danger p-0" onclick="removeItem('${item.name}')">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            updateModuleTotals();
        }

        function updateQuantity(itemName, change) {
            const module = moduleData[currentModule];
            const item = module.items.find(i => i.name === itemName);
            
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeItem(itemName);
                } else {
                    updateCartDisplay();
                    updateReceipt();
                }
            }
        }

        function updateQuantityInput(itemName, newQuantity) {
            const quantity = parseInt(newQuantity);
            if (quantity > 0) {
                const module = moduleData[currentModule];
                const item = module.items.find(i => i.name === itemName);
                if (item) {
                    item.quantity = quantity;
                    updateCartDisplay();
                    updateReceipt();
                }
            }
        }

        function removeItem(itemName) {
            const module = moduleData[currentModule];
            module.items = module.items.filter(item => item.name !== itemName);
            updateCartDisplay();
            updateReceipt();
        }

        function updateModuleTotals() {
            const module = moduleData[currentModule];
            module.subtotal = module.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            module.tax = module.subtotal * VAT_RATE;
            module.total = module.subtotal + module.tax;
            
            // Update UI
            document.getElementById(`${currentModule}Subtotal`).textContent = `$${module.subtotal.toFixed(2)}`;
            document.getElementById(`${currentModule}Tax`).textContent = `$${module.tax.toFixed(2)}`;
            document.getElementById(`${currentModule}Total`).textContent = `$${module.total.toFixed(2)}`;
        }

        function updateReceipt() {
            const module = moduleData[currentModule];
            const receiptContainer = document.getElementById(`${currentModule}ReceiptItems`);
            
            if (!receiptContainer) return;
            
            if (module.items.length === 0) {
                receiptContainer.innerHTML = '<div class="text-center text-muted">--- No items ---</div>';
                return;
            }
            
            receiptContainer.innerHTML = module.items.map(item => `
                <div class="receipt-item">
                    <div>${item.name} x${item.quantity}</div>
                    <div>${item.price > 0 ? `$${(item.price * item.quantity).toFixed(2)}` : 'Variable'}</div>
                </div>
            `).join('');
            
            updateModuleTotals();
        }

        // Action Functions
        function attachRestaurantToRoom() {
            const roomSelect = document.getElementById('restaurantRoomSelect');
            const room = roomSelect.value;
            
            if (!room) {
                alert('Please select a room first');
                return;
            }
            
            moduleData.restaurant.attachedRoom = room;
            document.getElementById('restaurantReceiptRoom').textContent = room;
            alert(`Restaurant bill attached to Room ${room}`);
        }

        function attachActivitiesToRoom() {
            const roomSelect = document.getElementById('activitiesRoomSelect');
            const room = roomSelect.value;
            
            if (!room) {
                alert('Please select a room first');
                return;
            }
            
            moduleData.activities.attachedRoom = room;
            document.getElementById('activitiesReceiptRoom').textContent = room;
            alert(`Activities attached to Room ${room}`);
        }

        function attachToRoom(module) {
            if (module === 'restaurant') {
                attachRestaurantToRoom();
            } else if (module === 'activities') {
                attachActivitiesToRoom();
            } else {
                alert('Attached to room successfully');
            }
        }

        function processPayment(module) {
            const mod = moduleData[module];
            if (mod.items.length === 0) {
                alert(`No items to pay for in ${module}`);
                return;
            }
            
            document.getElementById('paymentTotal').textContent = `$${mod.total.toFixed(2)}`;
            document.getElementById('paymentModalTitle').textContent = `${module.charAt(0).toUpperCase() + module.slice(1)} Payment`;

            // Show kitchen option only for restaurant
            const kitchenRow = document.getElementById('paymentSendToKitchenRow');
            const kitchenCheckbox = document.getElementById('paymentSendToKitchen');
            if (kitchenRow) {
                if (module === 'restaurant') {
                    kitchenRow.style.display = 'block';
                    if (kitchenCheckbox) kitchenCheckbox.checked = false;
                } else {
                    kitchenRow.style.display = 'none';
                }
            }

            // set the current module to the module being paid
            currentModule = module;

            paymentModal.show();
        }

        function confirmPayment() {
            const mod = moduleData[currentModule];
            const kitchenCheckbox = document.getElementById('paymentSendToKitchen');
            if (kitchenCheckbox && kitchenCheckbox.checked && currentModule === 'restaurant') {
                addToKitchen();
            }

            alert(`Payment of $${mod.total.toFixed(2)} processed successfully!`);
            clearModuleOrder(currentModule);
            paymentModal.hide();
        }

        function printReceipt(module) {
            const mod = moduleData[module];
            if (mod.items.length === 0) {
                alert(`No items to print for ${module}`);
                return;
            }
            
            const receiptContent = document.getElementById(`${module}Receipt`).innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${module.charAt(0).toUpperCase() + module.slice(1)} Receipt</title>
                    <style>
                        body { font-family: 'Courier New', monospace; padding: 20px; max-width: 300px; margin: 0 auto; }
                        .header { text-align: center; border-bottom: 1px dashed #000; padding-bottom: 10px; }
                        .item { display: flex; justify-content: space-between; margin: 5px 0; }
                        .total { border-top: 1px dashed #000; padding-top: 10px; margin-top: 15px; font-weight: bold; }
                    </style>
                </head>
                <body>
                    ${receiptContent}
                    <button onclick="window.print()" style="margin-top: 20px; padding: 10px; background: #007bff; color: white; border: none; border-radius: 5px;">
                        Print Receipt
                    </button>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        function clearModuleOrder(module) {
            if (confirm(`Clear all items from ${module}?`)) {
                moduleData[module].items = [];
                updateCartDisplay();
                updateReceipt();
            }
        }

        function emailReceipt(module) {
            const mod = moduleData[module];
            if (mod.items.length === 0) {
                alert(`No items to email for ${module}`);
                return;
            }
            alert(`Receipt sent to guest email`);
        }

        function viewRoomStatement() {
            const room = moduleData.accommodation.selectedRoom;
            alert(`Opening statement for Room ${room}`);
        }

        function addToKitchen() {
            alert('Order sent to kitchen');
        }

        function scheduleActivity() {
            alert('Schedule activity dialog would open here');
        }

        function addParticipants() {
            alert('Add participants dialog would open here');
        }

        function bookVenue() {
            alert('Book venue dialog would open here');
        }

        function addGuestCount() {
            alert('Add guest count dialog would open here');
        }

        function bookConference() {
            alert('Book conference room dialog would open here');
        }

        function addAttendees() {
            alert('Add attendees dialog would open here');
        }

        function addProject() {
            alert('Add project dialog would open here');
        }

        function addContractor() {
            alert('Add contractor dialog would open here');
        }

        function saveOrder(module) {
            alert(`${module.charAt(0).toUpperCase() + module.slice(1)} order saved`);
        }

        // Settings functionality
        function openSettingsModal() {
            // Activate settings module (non-modal)
            document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
            const btn = document.querySelector('.sidebar-item[data-module="settings"]') || document.getElementById('settingsBtn');
            if (btn) btn.classList.add('active');

            document.querySelectorAll('.module-content').forEach(m => m.classList.remove('active'));
            const settingsEl = document.getElementById('settings-module');
            if (settingsEl) settingsEl.classList.add('active');

            currentModule = 'settings';
            currentCategory = null;

            renderSettingsRestaurantList();
            renderSettingsRoomsList();
            renderSettingsInventoryList();
        }

        function renderSettingsRestaurantList() {
            const container = document.getElementById('settingsRestaurantList');
            container.innerHTML = '';
            const categories = Object.keys(moduleData.restaurant.itemsList);
            categories.forEach(category => {
                const group = document.createElement('div');
                group.className = 'mb-3';
                group.innerHTML = `<h6 class="mb-2">${category.charAt(0).toUpperCase() + category.slice(1)}</h6>`;
                moduleData.restaurant.itemsList[category].forEach((it, idx) => {
                    const row = document.createElement('div');
                    row.className = 'd-flex justify-content-between align-items-center mb-2';
                    row.innerHTML = `
                        <div>
                            <strong>${it.name}</strong><br>
                            <small class="text-muted">$${it.price.toFixed(2)}</small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-danger" onclick="removeRestaurantItem('${category}', ${idx})">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    `;
                    group.appendChild(row);
                });
                container.appendChild(group);
            });
        }

        function addRestaurantItemFromSettings() {
            const name = document.getElementById('newRestaurantItemName').value.trim();
            const price = parseFloat(document.getElementById('newRestaurantItemPrice').value);
            const category = document.getElementById('newRestaurantItemCategory').value;
            if (!name || isNaN(price)) {
                alert('Please provide a valid name and price');
                return;
            }
            moduleData.restaurant.itemsList[category].push({ name, price, icon: 'bi-bag' });
            document.getElementById('newRestaurantItemName').value = '';
            document.getElementById('newRestaurantItemPrice').value = '';
            renderSettingsRestaurantList();
            if (currentModule === 'restaurant' && currentCategory === category) loadCurrentModuleItems();
        }

        function removeRestaurantItem(category, idx) {
            if (confirm('Remove this menu item?')) {
                moduleData.restaurant.itemsList[category].splice(idx, 1);
                renderSettingsRestaurantList();
                if (currentModule === 'restaurant' && currentCategory === category) loadCurrentModuleItems();
            }
        }

        function renderSettingsRoomsList() {
            const container = document.getElementById('settingsRoomsList');
            container.innerHTML = '';
            moduleData.accommodation.rooms.forEach((r, idx) => {
                const row = document.createElement('div');
                row.className = 'd-flex justify-content-between align-items-center mb-2';
                row.innerHTML = `
                    <div>
                        <strong>${r.value}</strong><br>
                        <small class="text-muted">${r.label}</small>
                    </div>
                    <div>
                        <button class="btn btn-sm btn-danger" onclick="removeRoom(${idx})">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(row);
            });
        }

        function addRoomFromSettings() {
            const value = document.getElementById('newRoomValue').value.trim();
            const label = document.getElementById('newRoomLabel').value.trim();
            if (!value || !label) {
                alert('Please provide room number and label');
                return;
            }
            moduleData.accommodation.rooms.push({ value, label });
            document.getElementById('newRoomValue').value = '';
            document.getElementById('newRoomLabel').value = '';
            renderSettingsRoomsList();
            updateRoomSelects();
        }

        function removeRoom(idx) {
            if (confirm('Remove this room?')) {
                moduleData.accommodation.rooms.splice(idx, 1);
                renderSettingsRoomsList();
                updateRoomSelects();
            }
        }

        function renderSettingsInventoryList() {
            const container = document.getElementById('settingsInventoryList');
            container.innerHTML = '';
            moduleData.inventory.items.forEach((it, idx) => {
                const row = document.createElement('div');
                row.className = 'd-flex justify-content-between align-items-center mb-2';
                row.innerHTML = `
                    <div>
                        <strong>${it.name}</strong><br>
                        <small class="text-muted">Qty: ${it.qty}</small>
                    </div>
                    <div>
                        <button class="btn btn-sm btn-danger" onclick="removeInventory(${idx})">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(row);
            });
        }

        function addInventoryFromSettings() {
            const name = document.getElementById('newInventoryName').value.trim();
            const qty = parseInt(document.getElementById('newInventoryQty').value);
            if (!name || isNaN(qty) || qty < 0) {
                alert('Please provide a valid name and quantity');
                return;
            }
            moduleData.inventory.items.push({ name, qty });
            document.getElementById('newInventoryName').value = '';
            document.getElementById('newInventoryQty').value = '';
            renderSettingsInventoryList();
        }

        function removeInventory(idx) {
            if (confirm('Remove this inventory item?')) {
                moduleData.inventory.items.splice(idx, 1);
                renderSettingsInventoryList();
            }
        }

        function updateRoomSelects() {
            const selects = [ 'accommodationRoomSelect', 'restaurantRoomSelect', 'activitiesRoomSelect' ];
            selects.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;
                el.innerHTML = '<option value="">Select Room (Optional)</option>' + moduleData.accommodation.rooms.map(r => `\n                    <option value="${r.value}">${r.label}</option>`).join('');
            });
        }

        // Initialize
        updateRoomSelects();
        init();

        // Global functions
        window.updateQuantity = updateQuantity;
        window.updateQuantityInput = updateQuantityInput;
        window.removeItem = removeItem;
    </script>
</body>
</html>